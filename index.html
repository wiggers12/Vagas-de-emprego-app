<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>App Jiu-Jitsu</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #000;
      color: #fff;
    }
    header {
      background: #FFD700;
      color: #000;
      padding: 15px;
      text-align: center;
      font-weight: bold;
      font-size: 22px;
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #111;
      padding: 10px 0;
    }
    nav button {
      background: none;
      border: none;
      color: #fff;
      font-size: 16px;
      cursor: pointer;
    }
    nav button:hover { color: #FFD700; }
    section {
      display: none;
      padding: 20px;
    }
    section.active { display: block; }
    .card {
      background: #111;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin: 5px 0 15px 0;
      border-radius: 5px;
      border: 1px solid #FFD700;
      background: #000;
      color: #fff;
    }
    button.action {
      background: #FFD700;
      color: #000;
      padding: 10px 15px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
    }
    button.action:hover { background: #e6c200; }
    img.profile-pic {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
    }
    canvas {
      background: #222;
      margin-top: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <header>App Jiu-Jitsu</header>
  <nav>
    <button onclick="showSection('home')">Home</button>
    <button onclick="showSection('perfil')">Perfil</button>
    <button onclick="showSection('treinos')">Treinos</button>
    <button onclick="showSection('metas')">Metas</button>
    <button onclick="showSection('videos')">Vídeos</button>
  </nav>

  <!-- Home -->
  <section id="home" class="active">
    <h2>Bem-vindo ao App Jiu-Jitsu</h2>
    <p>Acompanhe sua evolução como atleta.</p>
  </section>

  <!-- Pacote 1: Perfil -->
  <section id="perfil">
    <h2>Cadastro do Atleta</h2>
    <img id="profilePic" class="profile-pic" src="" alt="Foto de Perfil">
    <input type="file" id="fotoInput" accept="image/*" />
    <input id="nome" placeholder="Nome" />
    <input id="sobrenome" placeholder="Sobrenome" />
    <input id="idade" type="number" placeholder="Idade" />
    <select id="graduacao">
      <option value="">Selecione a graduação</option>
      <option>Branca</option>
      <option>Azul</option>
      <option>Roxa</option>
      <option>Marrom</option>
      <option>Preta</option>
    </select>
    <input id="tempoTreino" placeholder="Tempo de treino (anos)" />
    <input id="peso" placeholder="Peso (kg)" />
    <input id="altura" placeholder="Altura (cm)" />
    <input id="equipe" placeholder="Equipe / Academia" />
    <input id="objetivo" placeholder="Objetivo principal" />
    <input id="telefone" placeholder="Telefone" />
    <input id="email" placeholder="E-mail (opcional)" />
    <button class="action" onclick="salvarPerfil()">Salvar Cadastro</button>

    <h3>Histórico de Campeonatos</h3>
    <input id="campeonatos" placeholder="Quantos campeonatos já lutou" />
    <input id="vitorias" placeholder="Vitórias" />
    <input id="derrotas" placeholder="Derrotas" />
    <input id="melhorColocacao" placeholder="Melhor colocação" />
    <input id="ultimaParticipacao" placeholder="Última participação (nome e data)" />
    <button class="action" onclick="salvarHistorico()">Salvar Histórico</button>

    <canvas id="grafico" width="300" height="200"></canvas>
  </section>

  <!-- Treinos -->
  <section id="treinos">
    <h2>Agenda de Treinos</h2>
    <div id="listaTreinos" class="card">Carregando...</div>
  </section>

  <!-- Metas -->
  <section id="metas">
    <h2>Minhas Metas</h2>
    <div id="listaMetas" class="card">Carregando...</div>
  </section>

  <!-- Vídeos -->
  <section id="videos">
    <h2>Vídeos</h2>
    <div id="listaVideos" class="card">Carregando...</div>
  </section>

  <!-- Firebase -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
    import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

    // Config do seu Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyC1WaaBD9XXRoMGgiKRU_qTLcQ5CdNHQKs",
      authDomain: "vagas-de-emprego-app.firebaseapp.com",
      projectId: "vagas-de-emprego-app",
      storageBucket: "vagas-de-emprego-app.appspot.com",
      messagingSenderId: "301719945007",
      appId: "1:301719945007:web:e2b5141d1fc941bd11ebda",
      measurementId: "G-JRJBBRWG2R"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Navegação
    window.showSection = function(id) {
      document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
      document.getElementById(id).classList.add("active");
    };

    // Salvar perfil
    window.salvarPerfil = async function() {
      let perfilRef = doc(db, "atleta", "perfil");
      await setDoc(perfilRef, {
        nome: document.getElementById("nome").value,
        sobrenome: document.getElementById("sobrenome").value,
        idade: document.getElementById("idade").value,
        graduacao: document.getElementById("graduacao").value,
        tempoTreino: document.getElementById("tempoTreino").value,
        peso: document.getElementById("peso").value,
        altura: document.getElementById("altura").value,
        equipe: document.getElementById("equipe").value,
        objetivo: document.getElementById("objetivo").value,
        telefone: document.getElementById("telefone").value,
        email: document.getElementById("email").value,
        foto: document.getElementById("profilePic").src
      }, { merge: true });
      alert("Perfil salvo!");
    };

    // Salvar histórico
    window.salvarHistorico = async function() {
      let historicoRef = doc(db, "atleta", "historico");
      await setDoc(historicoRef, {
        campeonatos: document.getElementById("campeonatos").value,
        vitorias: document.getElementById("vitorias").value,
        derrotas: document.getElementById("derrotas").value,
        melhorColocacao: document.getElementById("melhorColocacao").value,
        ultimaParticipacao: document.getElementById("ultimaParticipacao").value,
      }, { merge: true });
      alert("Histórico salvo!");
      desenharGrafico();
    };

    // Upload de foto
    document.getElementById("fotoInput").addEventListener("change", async (e) => {
      const file = e.target.files[0];
      const storageRef = ref(storage, "perfil/foto.jpg");
      await uploadBytes(storageRef, file);
      const url = await getDownloadURL(storageRef);
      document.getElementById("profilePic").src = url;
    });

    // Gráfico vitórias/derrotas
    function desenharGrafico() {
      const canvas = document.getElementById("grafico");
      const ctx = canvas.getContext("2d");
      ctx.clearRect(0,0,canvas.width,canvas.height);
      const v = parseInt(document.getElementById("vitorias").value) || 0;
      const d = parseInt(document.getElementById("derrotas").value) || 0;
      const total = v+d || 1;
      ctx.fillStyle = "#0f0"; 
      ctx.fillRect(20,20,(v/total)*260,40);
      ctx.fillStyle = "#f00"; 
      ctx.fillRect(20,80,(d/total)*260,40);
      ctx.fillStyle = "#fff";
      ctx.fillText("Vitórias: "+v, 20, 15);
      ctx.fillText("Derrotas: "+d, 20, 75);
    }
  </script>
</body>
</html>